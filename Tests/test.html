<head>
  <title>Minist Browser</title>
  <meta name="description" content="This description is shown in italic. This page is a demo test of ./w TUI command-line minimalist textual web-page reader" />
  <meta name="keywords" content="webbrowser, text, textual, TUI, demo, test page, minimalist, web browser, chrome, ./w, netscape, firefox" />

  <!-- base href="http://w.minimalist.yesco.org/foo/index.html" /> -->
  <script>You won't see this either</script>
  <style>or this...</style>
</head>
<h1>Minimialist Browser</h1>

<p>
This is a test of the <i>minimalist</i> <tt>./w</tt> web-browser written in C. It is a meagre <b>&lt;1000 lines C-code</b> (comments, tests, and empty lines not counted).
</p>

<h2>History</h2>
<p>In the morning of August 4th, 2021, in the morning: it was a total 370 lines. <b>pre/code</b> added 10 lines, <b>word-wrap</b> 40, misc formatting improvements &mdash; 10 lines. I added 36 for handling <b>HTML entities</b>. Now, I didn't want to count pure comment lines &amp; nor empty lines; so changed my counting script; Adding <b>numbered entities</b>: Hex and deciaml; there are <b>345 lines</b> of <i>C</i>; Adding parsing of <b>attributes</b> added a whole lot: 70 lines. But then I did a general cleanup of most code, and got it down to 30ish lines! With simple table support, it's about 550 lines.
</p>

<h2>Features</h2>
<p><tt>./w</tt> isn't like other browsers. It's <i>new</i> and innovative, but it's <b>text</b> and <b>retro</b>, and it's specialized and generalized for the <em>user</em> &mdash; me!</p>

<p>That's all silly and good. Hopefully it may be useful to others.</p>

Here is a list of <i>features</i>:

<ul>

<li><tt>./w</tt> is modular and open, allwogin for customizations and extensions. It's <b>tiny</b> in size, but packs a buch!. The source is only <b>about 1000 LOC</b> (lines of code), plus 390 LOC (j)io-library, and an-ANSI graphics library (168 LOC).</li>

</li>

<li>It's a multi-tab browser. There is no limit on the number of tabs.</li>

<li>Each tab is just a history entry in the file <tt>./whistory</tt> and it's append only.</li>

<li>The <key>LEFT</key>-arrow goes <b>back</b> in the history, <key>RIGHT</key> goes forward.</li>

<li>Any tabs opened before this session was started are numbered 0, -1, -2, and down.</li>

<li>New tabs, links followed are numbered 1, 2, 3. We call these <i>future</i>-tabs, as they may have been unseen and are in the queue.</li>

<li>Each directory where it's started from is it's own <i>profile</i> and session, and keeps separate history and cache.</li>

<li>It's default mode is the <i>command line</i>. Just type the url and RET and it'll load in a new tab.</li>

</ul>

<h3>Keyboard navigation</h3>
<p>Using the keyboard you navigate the pages, and history. (Note that META- is same as ALT-key.</p>

Short summary:
<dl>

<dt>CTRL-DOWN or SPACE</dt><dd>page down (also <key>^V</key>)</dd>
<dt>CTRL-UP or M-DSPACE</dt><dd>page up (also <key>M-V</key>)</dd>

<dt>DOWN</dt><dd>scrolls down one row (also <key>RET</key> or <key>^N</key></dd>
<dt>UP</dt><dd>scrolls up one row (also <key>M-RET</key> or <key>^P</key>)</dd>

<dt>META-DOWN or M-&gt;</dt><dd>Go to last page</dd>
<dt>META-UP or M-&lt;</dt><dd>Go to first page</dd>

<dt>LEFT</dt><dd>go back (tab) in history (also <key>^B</key></dd>
<dt>RIGHT</dt><dd>go forward (tab) in history<key>^F</key></dd>

<dt>c RET</dt><dd>type any link short-cut and RETURN to open in new tab</dd>

<dt>*</dt><dd><b>star</b> (bookmark) current page and scroll location</dd>

<dt>^D</dt><dd><b>bookmark</b> current page, as star</dd>

</dl>

<h3>Command line</h3>
<p>As all good tools, <tt>./w</tt> has a command line, it's its default interface. It's your information center. The folowing functions apply to the command line.</p>

The editing is limited:
<dl>
<dt>BACKSPACE</dt><dd>rubout last type char</dd>
<dt>^G</dt><dd>delete the line (and cancel &amp; redraw screen)</dd>
</dl>

<br>
<b>Notice:</b> that you can only type one <key>SPACE</tt> and not at the first position. If there is no space one is added, if last is a space, it's <i>page down</i>!.
<br>
<p>Commands are activated by <key>RETURN</eky> or some special characters or keys, like <key>^S</key>. This is the list of command formats:</p>

<dl>
<dt>a RET</dt>
<dt>ca RET</dt>
  <dd>any short-link will open in new tab</dd>

<dt>http://example.com</dt>
<dt>yesco.org</dt>
  <dd>URLs will be opened</dd>

<dt>foobar fiefum</dt>
  <dd>A DuckDuckGo search will be performed in new tab</dd>

<dt>3+4*2</dt>
  <dd>perform calculations with <code>bc -l</code>. Results are shown on the same line after <tt>==&gt;</tt>

<dt>foo ^S</dt>
  <dd>search current page for "foo"</dd>

<dt>^G</dt>
  <dd>cancels search and deletes the command</dd>

<dt>foo ^O</dt>
  <dd>narrow display to only matching lines. <key>^S</key> switches back to seach. </dd>
  
<dt>! ls</dt>
  <dd><i>bang:</i> run the unix command. When finished press <key>^L</key> to redsplay page and continue editing the command or <key>^G to cancel</dd>

<dt>#cool</dt>
  <dd><b>hashtag:</b> (bookmark) the current page</dd>

<dt>$write a note about the page</dt>
  <dd><b>note:</b> make a searchable not</dd>

<dt>=cool</dt>
<dt>=cool ^S</dt>
  <dd>search for mentions of cool in bookmarks (end with <key>RETURN</key> or <key>^S</key> </dd>

<dt>#cool ^S</dt>
  <dd>search for hashtag <key>#cool</key>.</dd>

<dt>@G RET</dt>
  <dd>assign a <b>shortcut-key</b> to the current page "google.com" (? and position). Last one rules. Activate with <keyt>ALT-G</. All <key>ALT-letter</key> are reserved for the user.</dd>

<dt>/foo RET</dt>
<dt>&amp;foo RET</dt>
  <dd>same as <key>foo ^S</key> or <key>foo ^O</key> (from <tt>less</tt>)</dd>

</dl>

<h3>How does it work?</h3>

<br><tt>./w</tt> has several components:</p>

  <ul>
    <li><tt>./w</tt> - overall starting script</li>
    <li><tt>./wdownload</tt> - downloads/co;ies a file and renders it</li>
    <li>./w.x - html2ansi converter</li>
    <li>./wdisplay - shows a screen-ful of lines from an ansi-fil start from top-line</li>
    <li>./wless.x - an ANSI-file pager, UI, and what we'd call "the browser".</li>
  </ul>

Description the most important components:

<li><tt>./wdownload</tt> uses <tt>wget</tt>, but could as easily use <tt>curl</tt>. It just seems wget is a bit more "friendly" and DWIMMy wheras curl is better for embedding as a library.</li>

<li>The browser is <i>stateless</i>. It stoes no state that isn't made permanent. Eachnew tasb, scroll in a page, etc, logs and updates position permantly for that "tab".</li>

<li>Each directory where it's started from gets it's own browser history and cache. It contains status info and </li>

<li><tt>./w</tt> runs from its source code directory, It will automatically re-compile if the sources changed.</li>

</ul>

<h2>Individual Tests</h2>
<p>There are no automated test yet, as it's still relatively heavy in development.</p>

<ul id='list'>
<li><a href='#entities'>HTML Entities</a></li>
<li><a href='#list'>This is a List</a></li>
<li><a href='#todo'>The TODO list at the end</a></li>
<li><a href='#nestedlists'>Nested Lists</a></li>
<li><a href='dl.html'>Definition Lists</a></li>
<li><a href='links.html'>Links test page</a></li>
<li><a href='links-corner-cases.html'>Corner-cases links page</a></li>
<li><a href='links-many.html'>Many Links test page</a></li>
<li><a href='table.html'>Simle Table</a></li>
<li><a href='table-shortened.html'>Simle Table without end-tags</a></li>
<li><a href='table-complex.html'>Complex Table</a></li>
<li><a href='table-crazy.html'>Crazy Table</a></li>
<li><a href='words.html'>Testing of word-wrap (with Unicode)</a></li>
<li><a href='unicode-pre.html'>Pre-unicode, test width of fullwidth chars</a></li>
<li><a href='color.html'>Testing of colors</a></li>
</ul>

<h2 id='entities'>HTML Entities</h2>

<P>As you saw above; it supports <b>named entities</b> (caveat inline without surrounded by space, see bug below). Did you know that the list of HTML entties is <b>2234</b> elements long! &amp; <tt> &amp;amp;</tt> &lt; <tt> &amp;lt;</tt>  &gt; <tt>&amp;gt;</tt> are just few examples.</p>

<p>It supports <b>numbered entities</b> on the form: This is decimal 'A': &#65; <tt> &amp;#4711;</tt>, and fullwidth 'ï¼¡': &#xff21; <tt> &amp;#xff21</tt>.</p>

<p><b>Links</b> are rendered <a href="http://google.com/">Google</a> but there is no navigation or paging.</p>

<p>
Below continues various plain simple html. CSS is <b>not</b> handled. But all other tags <i>should</i> be (Terminal bug: 'o' in should is overwritten and looks like 'p'). Can you mix: <b>bold <i>bold italics</i> bold</b> or <i>italics <b>italics bold</b> italics</i>.
</p>

<h2>Comments</h2>
<p>4see: <b>seebold1 seebold2</b>nospacesee3

<!-- Not see this: <error> this is ->a comment -->

see4
</p>

<h2 id='nestedlists'>Nested Lists</h2>
A list:
<ul>
<li>one</li>
<li>two</li>
<li>three</li>
<ul>
<li>aaaa</li>
<li>bbbb</li>
<li>cccc</li>
</ul>
<li>four</li><li>five</li><li>six</li>
</ul>
End of list.
<br><br>
List items without end tag:
<ul>
 <li>first
 <li>second

    <ul>
      <li>foo
      <li>bar
    </ul>
 <li>third <li>fourth
</ul>
After all.
<h2>pre</h2>

This is a small example of code:
<pre>
function fib(n) {
  if (n &lt; 1) return 0;
  if (n &lt; 2) return 1;
  return fib(n-1)+fib(n-2);
}
</pre>
Its implementation is recursive and expensive &mdash; <tt>O(2^n)</tt>.

<title>Inline title</title>
<h0>Header 0! LOL</h0>
<h0>Header 0! LOL</h0>
<h1>Header 1</h1>
<h1>Header 1</h1>
<h2>Header 2</h2>
<h2>Header 2</h2>
<h3>Header 3</h3>
<h3>Header 3</h3>
<h4>Header 4</h4>
<h4>Header 4</h4>
<h5>Header 5</h5>
<h5>Header 5</h5>
<h6>Header 6</h6>
<h6>Header 6</h6>
<p>Blah blahbalhbal albhablab ablahblabhalbla blabhalbahbla bahbl ablhaba</p>

<h1>DONE/Fixed bugs</h1>
<ul>
<li>A text with inline&amp;code with no spaces ( &amp; ) (&amp;).</li>
<li>&amp; tokens currently takes up as much space as the code is long, need to not count those characters... When to finish? ';' is not enough.</li>
<li>Some code are &amp-without the ";" or just a single & or illegal &foobar <tt> &amp;amp</tt> without the ';' &mdash; this is a parsing problem.</li>
<li>wordwrap used to count bytes, and break unicode chars - fixed</li>
<li>Not really a bug, but a matter of resilience of missing end tags. For example of the end li-tag is missing, indentation becomes messed up.</li>
<li>Handle larger font-sizes &lt;font size=+N&gt; and css="font-size:16px == double? = 4x4 font? Is there an ascii-art font in two lines?<br/>bubbleart,graceful:lower part of fire-font-s, <b>Calvin S</b> - a wire/boxgraphics font!, AMC 3 Liv1, bigfig! wire, Broadway KB !, Cyberlarge! Cybersmall! JS BLock Letters :  a 3 char high font in <a href="https://patorjk.com/software/taag/#p=testall&f=Graffiti&t=Jonas%20S%20Karlsson">ascii-art</a><br/>(4 high: rectangles, small, small slant, ascii new roman</li>
<li><b>images</b>? maybe this can help <a href="https://github.com/kristopolous/UniFig/blob/master/unifig.js">UniFig</a></li>
<li>show "line-line/lines" or page 1/4 at upper right corner 100% should mean can see end on screen (rows*100/lines)</li>
</ul>

<h1>Current Bugs</h1>

<h2>Terminal issues:</h2>
<ul>
<li>When resizing in Termux, background losses color at en dof line. Use CTRL-R to redraw. (TODO: automate getting new size and rerender ANSI)</li>
<li>A test with <i>italic when ending with a 'd' like 3d=ddd</i> you can't see the last 'd' fully. Possible fix: if it's a space after, "move" the space inside the end-italics tag. Not easy the way we parse...</li>
<li>Text background/underline wraps with nl, it's "correct" but ugly</li>
</ul>

<h2 id="annoy">Annoyances</h2>
Not really bugs causing crashes or direct problems (features?), but behaviour that could be fixed:
<ul>
<li><code>./w FILE</code> if open the same file as last, no need to add to history? Same with ALT-X?</li>
<li>link spanning line-end will underline indented spaces, haha, and <tt>will overflow</tt> solution is a delayed reformatting()? like recolor()?</li>
<li>in ^O only search, still move lines by actual line, not displayed...</li>
<li>Search cannot handle spaces, can't input! lol</li
</ul>

<li>Search will match numbers and data from hidden text, as well as link url and ESC ANSI codes - how much do I care?</li>

<h2 id="todo">TODO:</h2>
<ul>

<li>Handle image tag, show alt. Image maps too.</li>

<li>Navigate to links by cursor movements.</li>

<li> &lt; ordered lists!</li>

<li>handle &lt;foo id="name"&gt; #name links, and be able to go to them; need to embed-hide it in the .ansi-file! (all id/name?) &lt;a name="foo"&gt; is <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate">deprecated</a>.</li>

</ul>

<h2>Bugs in ./w</h2>
<ul>

<li>After &lt; h2 &lt; if there is no text following the h2 takes 2 lines (with same background color)</li>

<li>Much improved, but...still word-wrap for unicode occasionally messes up some charact...? Tests/words.html</li>

<li>headers than span more than one line, don't break lines correctly, this messess up the output of wdisplay...

<li>URL#foo need to strip #foo when loading?</li>

<li>Need to decode attributes: yahoo.com encodes href... - https:%26%23x2F%3b%26%23x2F%3bnews.yahoo.com%26%23x2F%3b.ansi LOL</li>

<li>Wrap too early, and space missing, COLS=39:<br>aa b c d e f g h i j k l m n o p Q R s t u v w x y z</li>

<li>ab cd ef gh ij kl mn op qr st uv wx yz</li>

<li>when go to page, if cached it never updates</li>

<li>rewrite /FOO/../ => /FOO/ test here=<a href="https://lysator.liu.se/foreningen/../lokaler">lysator.liu.se/foreningen/../lokaler</a>.</li>

<li>Some things don't render, depending on URL like <a href="https://liu.se/biblioteket">liu.se/biblioteket</a></li> is ok, but not <a href="https://liu.se/biblioteket">https://liu.se/biblioteket</a>. ??? <a href="bbc.com">bbc.com</a> also gives trouble.</li>

<li>headlines full-width characters doesincorrect wrapping (no insert \n) when text not fit on one line? (even if we counting?)</li>

<li>searching doesn't find text in headers as they are fullwidth characters, could print it hidden with ^M so it'll match (but not visible) ^O would print it, but in either case: no hilite</li>

</li>

</ul>

